<!DOCTYPE html>
<html lang="de" translate="no">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="google" content="notranslate">
    <meta name="robots" content="notranslate">
    <title>Video Detail - LearnAndEarn</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="auth.css">
    <link rel="stylesheet" href="mobile.css">
    <style>
        /* Prevent text selection on learning content */
        .notranslate {
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
        
        /* Allow selection only in specific areas */
        .selectable-sentence {
            -webkit-user-select: text !important;
            -moz-user-select: text !important;
            -ms-user-select: text !important;
            user-select: text !important;
        }
        
        /* Disable right-click on learning content */
        .learning-content {
            -webkit-touch-callout: none;
        }
    </style>
</head>
<body>
    <div id="userHeader" class="user-header" style="display: none;">
                    <div class="nav-links">
                <a href="/home.html" class="nav-link">Startseite</a>
                <a href="/search.html" class="nav-link">Videosuche</a>
                <a href="/vocabulary.html" class="nav-link">Vokabeln</a>
                <a href="/fill-in-the-blanks.html" class="nav-link">L√ºckentexte</a>
                <a href="/questions.html" class="nav-link">Fragen</a>
                <a href="/progress.html" class="nav-link">Mein Fortschritt</a>
                <a href="/learning-time.html" class="nav-link">Lernzeit</a>
            </div>
        <div class="user-menu">
            <div class="user-info">
                <span>Welcome, <span class="user-name" id="userName"></span></span>
                <span class="user-role" id="userRole"></span>
            </div>
            <div class="user-actions">
                <a href="/profile.html">My Profile</a>
                <button class="logout-button" onclick="logout()">Logout</button>
            </div>
        </div>
    </div>
    
    <div class="container">
        <div class="header-nav">
            <a href="/search.html" class="back-button">‚Üê Back to Search</a>
        </div>
        
        <div id="videoDetail" class="video-detail-container">
            <p class="loading">Loading video details...</p>
        </div>
        
        <div class="video-summary">
            <h3>Summary</h3>
            <div id="summaryContent" class="summary-content learning-content notranslate">
                <!-- Summary will be loaded here -->
            </div>
        </div>
    </div>
    
    <!-- Dictation Modal -->
    <div id="dictationModal" class="dictation-modal" style="display: none;">
        <div class="dictation-content">
            <span class="close-button">&times;</span>
            <h2>Sprech√ºbung</h2>
            
            <div class="sentence-container">
                <div id="sentenceDisplay" class="sentence-display selectable-sentence"></div>
                <p class="selection-hint">üí° Tipp: Markieren Sie einen Teil des Satzes, um bestimmte Phrasen zu √ºben</p>
            </div>
            
            <div class="dictation-controls">
                <button id="playButton" class="control-button">
                    <span class="play-icon">‚ñ∂</span> Audio abspielen
                </button>
                <button id="slowPlayButton" class="control-button">
                    <span class="play-icon">‚ñ∂</span> Langsam abspielen
                </button>
            </div>
            
            <div id="speechResult" class="speech-result">
                <p class="result-label">Ihre Aussprache:</p>
                <div id="transcribedText" class="transcribed-text"></div>
                <textarea id="systemDictationInput" class="system-dictation-input" placeholder="Tippen Sie hier Ihren Text ein..." style="display: none; width: 100%; min-height: 60px; padding: 10px; font-size: 1.1em; border: 1px solid #e0e0e0; border-radius: 6px; resize: vertical;"></textarea>
            </div>
            
            <div class="speech-controls">
                <button id="startSpeechButton" class="speech-button">
                    <span class="mic-icon">üé§</span> Sprechen beginnen
                </button>
                <div id="listeningIndicator" class="listening-indicator" style="display: none;">
                    <span class="pulse"></span>
                    Zuh√∂ren...
                </div>
            </div>
            
            <div id="comparisonResult" class="comparison-result"></div>
            
            <div class="dictation-buttons">
                <button id="viewHistoryButton" class="history-button" style="display: none;">√úbungsverlauf anzeigen</button>
            </div>
            
            <div id="attemptCounter" class="attempt-counter" style="display: none;">
                <span class="attempt-count"></span>
            </div>
        </div>
    </div>
    
    <!-- Vokabeln Section -->
    <div class="container">
        <div class="section vocabulary-section">
            <h2>Vokabeln (Vocabulary)</h2>
            <div class="vocabulary-container">
                <div id="vocabLoading" class="loading-message" style="display: none;">
                    <div class="spinner"></div>
                    <p>Processing vocabulary with SpaCy...</p>
                    <p class="loading-detail">Analyzing German text with NLP model...</p>
                </div>
                <div id="vocabContent" style="display: none;">
                    <div class="vocab-controls">
                        <select id="practiceMode" class="practice-mode-selector">
                            <option value="einzelwort">Einzelwort</option>
                            <option value="satzauswahl">Satzauswahl</option>
                            <option value="wortauswahl">Wortauswahl</option>
                        </select>
                        <div class="vocab-stats">
                            <div class="stat-item">
                                <span class="stat-label">Total Words:</span>
                                <span id="totalWords" class="stat-value">0</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Unique Words:</span>
                                <span id="uniqueWords" class="stat-value">0</span>
                            </div>
                        </div>
                    </div>
                    <div class="vocab-grid" id="vocabGrid">
                        <!-- Vocabulary items will be inserted here -->
                    </div>
                    <div id="sentencesList" class="sentences-list" style="display: none;">
                        <!-- Sentences will be loaded here -->
                    </div>
                    <div id="wordSelectionList" class="word-selection-list" style="display: none;">
                        <!-- Word selection interface will be here -->
                    </div>
                </div>
                <div id="vocabPlaceholder" class="placeholder-text">
                    Click "Load Vocabulary" to analyze this video's vocabulary with SpaCy NLP.
                </div>
                <button class="btn btn-primary" id="loadVocabBtn">
                    Load SpaCy Vocabulary
                </button>
            </div>
        </div>
    </div>

    <!-- L√ºckentexte Section -->
    <div class="container">
        <div class="section cloze-section">
            <h2>L√ºckentexte (Cloze Tests)</h2>
            
            <!-- Exercise Type Selection -->
            <div class="cloze-type-selector">
                <label>√úbungstyp w√§hlen:</label>
                <div class="cloze-type-buttons">
                    <button class="cloze-type-btn" data-type="random">Zuf√§llig</button>
                    <button class="cloze-type-btn active" data-type="artikel">Artikel</button>
                    <button class="cloze-type-btn" data-type="verben">Verben</button>
                    <button class="cloze-type-btn" data-type="substantive">Substantive</button>
                    <button class="cloze-type-btn" data-type="adjektive">Adjektive</button>
                    <button class="cloze-type-btn" data-type="schwierig">Schwierige W√∂rter</button>
                </div>
            </div>
            
            <div class="cloze-container">
                <div id="clozeLoading" class="loading-message" style="display: none;">
                    <div class="spinner"></div>
                    <p>Generating cloze tests...</p>
                    <p class="loading-detail">Creating fill-in-the-blank exercises from video sentences...</p>
                </div>
                <div id="clozeContent" style="display: none;">
                    <div class="cloze-test" id="clozeTest">
                        <div class="cloze-dictation-controls">
                            <button id="clozeDictationBtn" class="btn btn-speech" onclick="openClozeDictation()" style="display: none;">
                                üé§ Sprech√ºbung
                            </button>
                        </div>
                        <p id="clozeSentence" class="cloze-sentence"></p>
                        <div class="cloze-options" id="clozeOptions"></div>
                        <div id="clozeResult" class="cloze-result" style="display: none;"></div>
                        <button id="nextClozeBtn" class="btn btn-secondary" style="display: none;">Next Question</button>
                    </div>
                    <div class="cloze-stats">
                        <span>Question <span id="currentQuestion">1</span> of <span id="totalQuestions">5</span></span>
                        <span>Score: <span id="clozeScore">0</span>/<span id="clozeAttempts">0</span></span>
                    </div>
                </div>
                <div id="clozePlaceholder" class="placeholder-text">
                    Click "Start Cloze Tests" to practice with fill-in-the-blank exercises.
                </div>
                <button class="btn btn-primary" id="startClozeBtn">
                    Start Cloze Tests
                </button>
            </div>
        </div>
    </div>
    
    <!-- Fragen Section -->
    <div class="container">
        <div class="section questions-section">
            <h2>Fragen (Questions)</h2>
            <div class="questions-container">
                <div id="questionsLoading" class="loading-message" style="display: none;">
                    <div class="spinner"></div>
                    <p>Generating questions...</p>
                    <p class="loading-detail">Creating comprehension questions from video content...</p>
                </div>
                <div id="questionsContent" style="display: none;">
                    <div class="question-test" id="questionTest">
                        <p id="questionText" class="question-text"></p>
                        <div class="question-options" id="questionOptions"></div>
                        <div id="questionResult" class="question-result" style="display: none;"></div>
                        <button id="nextQuestionBtn" class="btn btn-secondary" style="display: none;">Next Question</button>
                    </div>
                    <div class="question-stats">
                        <span>Question <span id="currentQuestionNum">1</span> of <span id="totalQuestionsNum">5</span></span>
                        <span>Score: <span id="questionScore">0</span>/<span id="questionAttempts">0</span></span>
                    </div>
                </div>
                <div id="questionsPlaceholder" class="placeholder-text">
                    Click "Start Questions" to practice with comprehension questions.
                </div>
                <button class="btn btn-primary" id="startQuestionsBtn">
                    Start Questions
                </button>
            </div>
        </div>
    </div>
    
    <!-- Practice History Modal -->
    <div id="historyModal" class="history-modal" style="display: none;">
        <div class="history-content">
            <span class="history-close">&times;</span>
            <h2>√úbungsverlauf</h2>
            <div id="historyList" class="history-list">
                <p class="loading">Verlauf wird geladen...</p>
            </div>
        </div>
    </div>
    
    <!-- Practice Modal for Vocabulary -->
    <div id="practiceModal" class="modal" style="display: none;">
        <div class="modal-content practice-content">
            <!-- Content will be dynamically added by JavaScript -->
        </div>
    </div>
    
    <script src="auth.js"></script>
    <script src="mobile-menu.js"></script>
    <script src="activity-monitor.js"></script>
    <script src="detail.js"></script>
</body>
</html>